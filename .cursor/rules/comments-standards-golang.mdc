---
title: PadrÃµes de ComentÃ¡rios - Go
description: Diretrizes especÃ­ficas para comentÃ¡rios em Go, incluindo godoc, exported symbols e convenÃ§Ãµes da linguagem.
tags: [comments, documentation, golang, go, godoc, code-review]
applies_to: ["**/*.go"]
---

# PadrÃµes de ComentÃ¡rios - Go

> **âš ï¸ OBRIGATÃ“RIO**: Esta regra complementa `comments-standards.mdc` com exemplos e convenÃ§Ãµes especÃ­ficas de Go.

> **ðŸ“š Leitura ObrigatÃ³ria**: Sempre consulte primeiro a regra genÃ©rica `comments-standards.mdc` para princÃ­pios universais.

---

## ConvenÃ§Ãµes EspecÃ­ficas do Go

### 1. Formato Godoc

Todo sÃ­mbolo exportado (comeÃ§a com letra maiÃºscula) **DEVE** ter comentÃ¡rio godoc.

**Formato padrÃ£o:**
```
// NomeDaFunÃ§Ã£o [descriÃ§Ã£o que comeÃ§a com o nome do sÃ­mbolo].
```

**CaracterÃ­sticas:**
- ComentÃ¡rio comeÃ§a com o nome exato do sÃ­mbolo
- Usa frases completas (maiÃºscula inicial, ponto final)
- Linha em branco separa parÃ¡grafos
- Sem linha em branco entre comentÃ¡rio e declaraÃ§Ã£o

---

## âŒ ComentÃ¡rios Ruins em Go

### 1. AÃ§Ãµes Ã“bvias

âŒ **RUIM**:
```go
// Tenta criar o recurso no serviÃ§o primÃ¡rio
result, err := primaryService.Create(ctx, data)

// Fallback para serviÃ§o secundÃ¡rio
result, err = secondaryService.Create(ctx, data)

// ConstrÃ³i a resposta
response := Response{
    ID: result.ID,
}
```

âœ… **BOM** (sem comentÃ¡rios necessÃ¡rios):
```go
result, err := primaryService.Create(ctx, data)
if err != nil {
    result, err = secondaryService.Create(ctx, data)
}

response := Response{
    ID: result.ID,
}
```

---

### 2. DescriÃ§Ãµes Redundantes

âŒ **RUIM**:
```go
// Create creates a new user and returns the created user
func (s *UserService) Create(ctx context.Context, req CreateUserRequest) (User, error)
```

âœ… **BOM**:
```go
// Create cria um novo usuÃ¡rio no sistema e envia email de boas-vindas.
// Retorna erro se o email jÃ¡ estiver em uso ou se o serviÃ§o de email falhar.
func (s *UserService) Create(ctx context.Context, req CreateUserRequest) (User, error)
```

---

### 3. ComentÃ¡rios de AtribuiÃ§Ã£o

âŒ **RUIM**:
```go
// Define o status como ativo
status := "active"

// ObtÃ©m o ID do usuÃ¡rio da requisiÃ§Ã£o
userID := req.UserID
```

âœ… **BOM** (sem comentÃ¡rios):
```go
status := "active"
userID := req.UserID
```

---

## âœ… ComentÃ¡rios Bons em Go

### 1. ExplicaÃ§Ã£o de LÃ³gica de NegÃ³cio

âœ… **BOM**:
```go
discount := 0.0 // PolÃ­tica comercial: sem desconto para primeira compra
if user.PreviousPurchases > 0 {
    discount = 0.1 // 10% para clientes recorrentes
}
```

âœ… **BOM**:
```go
// DetecÃ§Ã£o de fraude requer pelo menos 3 tentativas falhas em 5 minutos
// conforme definido no documento de seguranÃ§a SECP-2024-03
if failedAttempts >= 3 && timeSinceFirst < 5*time.Minute {
    return ErrSuspiciousActivity
}
```

---

### 2. RestriÃ§Ãµes TÃ©cnicas

âœ… **BOM**:
```go
CreatedAt: time.Now().UTC(), // Sempre usar UTC para timestamps de API (RFC 3339)
```

âœ… **BOM**:
```go
// API externa espera content como string JSON escapada, nÃ£o objeto.
// Ver documentaÃ§Ã£o: https://docs.external-api.com/v2/payloads
Content: contentJSON,
```

---

### 3. TODOs com Contexto

âœ… **BOM**:
```go
// TODO: Obter configuraÃ§Ã£o do usuÃ¡rio do banco de dados (Fase 2 - Sprint 5)
// Ticket: PROJ-1234
defaultConfig := getHardcodedDefaults()
```

âœ… **BOM**:
```go
// TODO: Substituir por padrÃ£o circuit breaker quando retry count > 3
// ReferÃªncia: https://github.com/org/architecture-docs/blob/main/patterns/circuit-breaker.md
// Ticket: ARCH-456
for i := 0; i < maxRetries; i++ {
    // ...
}
```

---

### 4. Algoritmos NÃ£o-Ã“bvios

âœ… **BOM**:
```go
// Usar exponential backoff para evitar sobrecarregar o serviÃ§o downstream.
// FÃ³rmula: delay = baseDelay * 2^attempt (limitado a maxDelay)
// Baseado no padrÃ£o descrito em: https://aws.amazon.com/blogs/architecture/exponential-backoff-and-jitter/
delay := min(baseDelay*(1<<attempt), maxDelay)
time.Sleep(delay)
```

---

### 5. Casos Extremos e Armadilhas

âœ… **BOM**:
```go
// String vazia Ã© vÃ¡lida aqui - significa "usar valor padrÃ£o do sistema"
if value == "" {
    value = defaultValue
}
```

âœ… **BOM**:
```go
// IMPORTANTE: Deve chamar Close() mesmo se ocorrer erro, caso contrÃ¡rio hÃ¡ vazamento de recursos.
// O defer garante execuÃ§Ã£o mesmo em caso de panic.
defer resource.Close()
```

---

## DocumentaÃ§Ã£o Godoc por Tipo de SÃ­mbolo

### 1. FunÃ§Ãµes e MÃ©todos Exportados

**Toda funÃ§Ã£o/mÃ©todo exportado DEVE ter godoc.**

âœ… **BOM**:
```go
// NewClient cria um novo client HTTP configurado para comunicaÃ§Ã£o com a API.
// Retorna erro se baseURL for invÃ¡lida ou apiKey for vazia.
func NewClient(ctx context.Context, config ClientConfig) (*Client, error) {
    // ...
}
```

âœ… **BOM** (com detalhes de parÃ¢metros e retorno):
```go
// ProcessPayment processa um pagamento e retorna o ID da transaÃ§Ã£o.
// O valor deve ser positivo e em centavos (ex: 1050 para R$ 10,50).
//
// Retorna ErrInvalidAmount se o valor for <= 0.
// Retorna ErrPaymentDeclined se o pagamento for recusado.
func (p *PaymentProcessor) ProcessPayment(ctx context.Context, req ProcessPaymentRequest) (string, error) {
    // ...
}
```

**Dica**: Incluir exemplo de uso em godoc quando a funÃ§Ã£o tiver uso nÃ£o-Ã³bvio:
```go
// ProcessPayment processa um pagamento e retorna o ID da transaÃ§Ã£o.
//
// Exemplo:
//
//	txID, err := processor.ProcessPayment(ctx, ProcessPaymentRequest{
//	    Amount: 1050,
//	    Method: PaymentMethodCreditCard,
//	})
func (p *PaymentProcessor) ProcessPayment(ctx context.Context, req ProcessPaymentRequest) (string, error) {
    // ...
}
```

---

### 2. Structs Exportadas

**Todo struct exportado DEVE ter godoc. Campos nÃ£o-Ã³bvios DEVEM ter comentÃ¡rios.**

âœ… **BOM**:
```go
// Config contÃ©m configuraÃ§Ãµes para inicializar o serviÃ§o.
type Config struct {
    BaseURL string
    APIKey  string
    
    // Timeout define tempo mÃ¡ximo de espera por requisiÃ§Ã£o.
    // Zero significa sem timeout (nÃ£o recomendado em produÃ§Ã£o).
    Timeout time.Duration
    
    // MaxRetries define nÃºmero mÃ¡ximo de tentativas em erro transitÃ³rio.
    // PadrÃ£o: 3
    MaxRetries int
}
```

---

### 3. Constantes Exportadas

**Constantes exportadas DEVEM ter godoc quando nÃ£o-Ã³bvias.**

âœ… **BOM** (grupo de constantes):
```go
// CÃ³digos de status HTTP customizados da API.
const (
    // StatusBusinessError indica erro de validaÃ§Ã£o de regra de negÃ³cio.
    StatusBusinessError = 422
    
    // StatusRateLimited indica que o cliente excedeu o rate limit.
    StatusRateLimited = 429
)
```

âœ… **BOM** (constante individual com contexto):
```go
const (
    // maxRetries baseado no SLA: 99.9% de sucesso em 3 tentativas.
    maxRetries = 3
    
    // retryDelay balanceia latÃªncia vs carga no serviÃ§o downstream.
    retryDelay = 5 * time.Second
)
```

---

### 4. Interfaces Exportadas

**Interfaces exportadas DEVEM ter godoc. MÃ©todos DEVEM ter comentÃ¡rios.**

âœ… **BOM**:
```go
// Repository define operaÃ§Ãµes de persistÃªncia para User.
// ImplementaÃ§Ãµes devem ser thread-safe e suportar context.
type Repository interface {
    // Create persiste um novo usuÃ¡rio.
    // Retorna ErrDuplicateEmail se email jÃ¡ existir.
    Create(ctx context.Context, user User) error
    
    // FindByID busca usuÃ¡rio por ID.
    // Retorna ErrNotFound se usuÃ¡rio nÃ£o existir.
    FindByID(ctx context.Context, id string) (User, error)
}
```

---

### 5. VariÃ¡veis de Erro Exportadas

**Erros exportados DEVEM explicar quando usar e como tratar.**

âœ… **BOM**:
```go
// ErrNotFound indica que o recurso nÃ£o foi encontrado.
// Tratar retornando HTTP 404.
var ErrNotFound = errors.New("resource not found")

// ErrInvalidInput indica dados de entrada invÃ¡lidos.
// Tratar retornando HTTP 400 com detalhes.
var ErrInvalidInput = errors.New("invalid input data")
```

---

### 6. Package Comment

**Todo package DEVE ter comentÃ¡rio descritivo no arquivo principal.**

âœ… **BOM**:
```go
// Package payment implementa processamento de pagamentos.
// Suporta cartÃ£o, PIX e boleto via gateways externos.
//
// Exemplo bÃ¡sico:
//
//	processor := payment.NewProcessor(config)
//	result, err := processor.Process(ctx, payment.Request{
//	    Amount: 1000,
//	    Method: payment.MethodCreditCard,
//	})
package payment
```

---

## ComentÃ¡rios Especiais em Go

### 1. Build Tags

ComentÃ¡rios que controlam compilaÃ§Ã£o condicional:

âœ… **BOM**:
```go
//go:build integration
// +build integration

// Arquivo com testes de integraÃ§Ã£o que requerem dependÃªncias externas.
// Execute: go test -tags=integration
package payment_test
```

---

### 2. Generated Code

Indicar cÃ³digo gerado automaticamente:

âœ… **BOM**:
```go
// Code generated by protoc-gen-go. DO NOT EDIT.
// versions:
// 	protoc-gen-go v1.28.0
// 	protoc        v3.19.4
// source: payment.proto

package payment
```

---

### 3. Compiler Directives

ComentÃ¡rios que instruem o compilador:

```go
//go:generate mockgen -source=repository.go -destination=mock_repository.go
//go:embed templates/*.html
//go:noinline
```

**Nota**: NÃ£o adicionar comentÃ¡rios explicativos extras, as diretivas sÃ£o auto-explicativas.

---

## Formato de ComentÃ¡rios em Go

### 1. ComentÃ¡rio de Linha Ãšnica
```go
// Este Ã© um comentÃ¡rio de linha Ãºnica
```

### 2. ComentÃ¡rio de MÃºltiplas Linhas
```go
// Primeira linha do comentÃ¡rio.
// Segunda linha do comentÃ¡rio.
// Terceira linha do comentÃ¡rio.
```

**Nota**: Go nÃ£o usa `/* */` para comentÃ¡rios godoc. Use sempre `//`.

### 3. ParÃ¡grafos em Godoc
```go
// Primeiro parÃ¡grafo descrevendo o sÃ­mbolo.
//
// Segundo parÃ¡grafo com detalhes adicionais.
// Pode ter mÃºltiplas linhas.
//
// Terceiro parÃ¡grafo com exemplos ou notas.
```

---

## ManutenÃ§Ã£o de ComentÃ¡rios em Go

### Remover ComentÃ¡rios Desatualizados

âŒ **RUIM**:
```go
// TODO: Implementar lÃ³gica de retry
// Isso serÃ¡ feito na Fase 2
// Update: Agora usando exponential backoff
// Update 2: Mudamos para circuit breaker
func sendRequest() {
    cb.Execute(func() error {
        // ...
    })
}
```

âœ… **BOM**:
```go
// sendRequest envia requisiÃ§Ã£o protegida por circuit breaker.
func sendRequest() {
    cb.Execute(func() error {
        // ...
    })
}
```

---

## Ferramentas para Validar ComentÃ¡rios

### Validar Godoc
```bash
# Visualizar documentaÃ§Ã£o godoc
go doc -all ./...

# Gerar documentaÃ§Ã£o HTML local
godoc -http=:6060
```

### Linters para ComentÃ¡rios
```bash
# golangci-lint com regras de comentÃ¡rios
golangci-lint run --enable=godot,godox,gocritic

# revive para convenÃ§Ãµes de comentÃ¡rios
revive -config revive.toml ./...
```

**Regras Ãºteis:**
- `godot`: Verifica se comentÃ¡rios terminam com ponto
- `godox`: Encontra TODOs/FIXMEs
- `gocritic`: Valida formato de comentÃ¡rios

---

## âœ… Checklist EspecÃ­fico de Go

Antes de fazer commit:

### Godoc ObrigatÃ³rio:
- [ ] FunÃ§Ãµes/mÃ©todos exportados tÃªm godoc
- [ ] Structs exportadas tÃªm godoc
- [ ] Interfaces exportadas tÃªm godoc e mÃ©todos documentados
- [ ] Constantes exportadas nÃ£o-Ã³bvias tÃªm godoc
- [ ] VariÃ¡veis de erro exportadas tÃªm godoc
- [ ] Package tem comment descritivo

### Formato Godoc:
- [ ] ComentÃ¡rio comeÃ§a com nome exato do sÃ­mbolo
- [ ] Usa frases completas (maiÃºscula, ponto final)
- [ ] Sem linha em branco entre comentÃ¡rio e cÃ³digo
- [ ] Linha em branco separa parÃ¡grafos

### Qualidade (aplica regra genÃ©rica):
- [ ] Sem comentÃ¡rios Ã³bvios ou redundantes
- [ ] TODOs tÃªm contexto completo
- [ ] ComentÃ¡rios desatualizados removidos
- [ ] LÃ³gica nÃ£o-Ã³bvia explicada

---

## ReferÃªncias Oficiais

- [Effective Go - Commentary](https://go.dev/doc/effective_go#commentary)
- [Go Code Review Comments - Doc Comments](https://github.com/golang/go/wiki/CodeReviewComments#doc-comments)
- [Godoc: documenting Go code](https://go.dev/blog/godoc)
- [Go Doc Comments Specification](https://go.dev/doc/comment)

---

**Ãšltima AtualizaÃ§Ã£o**: 15 de Novembro de 2025  
**VersÃ£o**: 1.0 (Go-Specific)  
**Baseado em**: `comments-standards.mdc` v2.0
